<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src='test_helper.js'></script>
  </head>

  <body>
    <ul id="songlist"></ul>
  </body>

  <script type="text/javascript">
    var artistSearchResponse = loadJSON('./fixtures/pinback_artist_search.json')

    function parseResponse(response) {
      var results = response.results;
      var artists = results[0].artists;
      var videos = results.map(function(result){
        return {
          id: result.id,
          name: result.song_title
        };
      });

      var simplifiedResponse = {
        // this will break if multiple artists
        artistName: artists[0].name,
        videos: videos
      };

      return simplifiedResponse;
    }

    function appendToList(list, item){
      var newItem = document.createElement('li');
      var itemTextNode = document.createTextNode(item);
      newItem.appendChild(itemTextNode);
      list.appendChild(newItem);
    }

    function displayArtistVideos(artistObject){
      var body = document.getElementsByTagName('body')[0];
      artistSection = buildArtistSection(artistObject);
      body.appendChild(artistSection);
    }

    function buildArtistSection(artistObject){
      var artistSection = document.createElement('div');
      artistSection.className = 'artistSection';

      header = buildHeader(artistObject.artistName);
      artistSection.appendChild(header);

      var videoList = document.createElement('ul');
      artistSection.appendChild(videoList);

      artistObject.videos.forEach(function(item){
        appendToList(videoList, displayVidInfo(item));
      })

      return artistSection;
    }

    function buildHeader(artistName){
      var header = document.createElement('h1');
      var headerText = document.createTextNode(artistName);
      header.appendChild(headerText);
      return header;
    }

    function displayVidInfo(vidInfo){
      return [vidInfo.id, vidInfo.name].join(' - ');
    }

    displayArtistVideos(parseResponse(artistSearchResponse));
  </script>
</html>

